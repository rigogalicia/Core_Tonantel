<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <body>

        <ui:composition template="./../principal.xhtml">

            <ui:define name="content">
                <div class="content-wrapper">
                    <section class="content">
                        <!--panel principa-->
                        <div class="panel panel-default">
                            <div class="panel-body">
                                <!-- encabezado -->
                                <div class="page-header">
                                    <h2>Supervisión de Avalúos</h2>
                                </div>
                                <!-- / encabezado -->
                                <!-- form contenido -->
                                <h:form id="supervision">
                                    <h:dataTable class="table table-striped" value="#{av_supervision.listSolicitud}" var="s">
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="SupSolicitud" value="Num.Solicitud"/>
                                                <h:inputText id="SupSolicitud" class="form-control" value="#{av_supervision.supervision.numSolicitud}">
                                                    <f:ajax event="blur" listener="#{av_supervision.buscarPorCampos()}" execute="SupSolicitud" render="supervision"/>
                                                </h:inputText>
                                            </f:facet>
                                             #{s.numSolicitud}
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="SupSolicitante" value="Solicitante"/>
                                                <h:inputText id="SupSolicitante" class="form-control" disabled="true"></h:inputText>
                                            </f:facet>
                                            #{s.solicitante}
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="SupDireccion" value="Dir Registrada"/>
                                                <h:inputText id="SupDireccion" class="form-control" disabled="true"></h:inputText>
                                            </f:facet>
                                            #{s.direccion}
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="SupAgencia" value="Agencia"/>
                                                <h:inputText id="supAgencia" class="form-control" value="#{av_supervision.supervision.agencia}">
                                                    <f:ajax event="blur" listener="#{av_supervision.buscarPorCampos()}" execute="supAgencia" render="supervision"/>
                                                </h:inputText>
                                            </f:facet>
                                            #{s.agencia}
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="SupAsesor" value="Asesor"/>
                                                <h:inputText id="SupAsesor" class="form-control" value="#{av_supervision.supervision.asesorNombre}">
                                                    <f:ajax event="blur" listener="#{av_supervision.buscarPorCampos()}" execute="SupAsesor" render="supervision"/>
                                                </h:inputText>
                                            </f:facet>
                                            #{s.asesorNombre}
                                        </h:column>
                                        <h:column rendered="#{av_supervision.supervision.est == '97' eq false}">
                                            <f:facet name="header">
                                                <h:outputLabel for="Supvaluador" value="Valuador"/>
                                                <h:selectOneMenu id="supValuador" class="form-control" value="#{av_supervision.supervision.valuador}" label="&nbsp;!">
                                                    <f:selectItem itemLabel="" itemValue=""/>
                                                    <f:selectItems value="#{av_supervision.valuador}"/> 
                                                    <f:ajax event="change" listener="#{av_supervision.buscarPorCampos()}" execute="supValuador" render="supervision"/>
                                                </h:selectOneMenu>
                                            </f:facet>
                                            #{s.valuador}
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="SupFecha" value="Fecha Solicitud"/>
                                                <h:inputText id="SupFecha" class="form-control" value="#{av_supervision.supervision.fechaSolicitud}" disabled="true">
                                                    <f:ajax event="blur" listener="#{av_supervision.buscarPorCampos()}" execute="SupFecha" render="supervision"/>
                                                </h:inputText>
                                            </f:facet>
                                            #{s.fechaSolicitud}
                                        </h:column>
                                        <h:column>
                                            <f:facet name="header">
                                                <h:outputLabel for="estado" value="Estado"/>
                                                <h:selectOneMenu id="estado" class="form-control-static" value="#{av_supervision.supervision.est}" onchange="submit()"
                                                                 valueChangeListener="#{av_supervision.filtrarDatos}">
                                                    <f:selectItem itemValue = "a" itemLabel = "Avalúo Generado" />
                                                    <f:selectItem itemValue = "b" itemLabel = "Avalúo en Proceso" />
                                                    <f:selectItem itemValue = "c" itemLabel = "Avalúo Realizado" /> 
                                                    <f:selectItem itemValue = "d" itemLabel = "Avalúo Autorizado" /> 
                                                    <f:selectItem itemValue = "e" itemLabel = "Avalúo Rechazado" /> 
                                                </h:selectOneMenu>
                                            </f:facet>
                                            #{s.estado} 
                                        </h:column>
                                        <h:column>
                                            <h:commandLink target="blank_" actionListener="#{av_supervision.verDetalleSolicitud(s)}">
                                                <samp class="glyphicon glyphicon-list-alt"></samp>
                                            </h:commandLink>
                                           
                                            <h:commandLink action="/vista/av/av_superasigna.xhtml" rendered="#{av_supervision.supervision.est == '97' || av_supervision.supervision.est == '98'}">
                                                <samp class="glyphicon glyphicon-ok" aria-hidden="true"/>
                                                <f:param name="numeroSolicitud" value="#{s.numSolicitud}"/>
                                            </h:commandLink>
                                        </h:column>
                                    </h:dataTable>
                                </h:form>
                                <!-- / form contenido -->
                            </div>
                        </div>
                        <!-- / panel principa-->
                    </section>
                </div>
                <footer class="main-footer">
                    <div class="pull-right hidden-xs">
                        <b>Versión</b> #{version.numero}
                    </div>
                    <strong>Copyright &copy; 2018</strong> #{version.autor}
                    <strong>#{version.institucion}</strong>
                </footer>
            </ui:define>

        </ui:composition>

    </body>
</html>
